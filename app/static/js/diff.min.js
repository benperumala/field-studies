/*
 * Javascript Diff Algorithm
 *  By John Resig (http://ejohn.org/)
 *  Modified by Chu Alan "sprite"
 *
 * Released under the MIT license.
 *
 * More Info:
 *  http://ejohn.org/projects/javascript-diff-algorithm/
 */
function escape(a){var b=a;return b=b.replace(/&/g,"&amp;"),b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/"/g,"&quot;")}function diff(a,b){for(var c=new Object,d=new Object,e=0;e<b.length;e++)null==c[b[e]]&&(c[b[e]]={rows:new Array,o:null}),c[b[e]].rows.push(e);for(var e=0;e<a.length;e++)null==d[a[e]]&&(d[a[e]]={rows:new Array,n:null}),d[a[e]].rows.push(e);for(var e in c)1==c[e].rows.length&&"undefined"!=typeof d[e]&&1==d[e].rows.length&&(b[c[e].rows[0]]={text:b[c[e].rows[0]],row:d[e].rows[0]},a[d[e].rows[0]]={text:a[d[e].rows[0]],row:c[e].rows[0]});for(var e=0;e<b.length-1;e++)null!=b[e].text&&null==b[e+1].text&&b[e].row+1<a.length&&null==a[b[e].row+1].text&&b[e+1]==a[b[e].row+1]&&(b[e+1]={text:b[e+1],row:b[e].row+1},a[b[e].row+1]={text:a[b[e].row+1],row:e+1});for(var e=b.length-1;e>0;e--)null!=b[e].text&&null==b[e-1].text&&b[e].row>0&&null==a[b[e].row-1].text&&b[e-1]==a[b[e].row-1]&&(b[e-1]={text:b[e-1],row:b[e].row-1},a[b[e].row-1]={text:a[b[e].row-1],row:e-1});return{o:a,n:b}}function diffString(a,b){a=a.replace(/\s+$/,""),b=b.replace(/\s+$/,"");var c=diff(""==a?[]:a.split(/\s+/),""==b?[]:b.split(/\s+/)),d="",e=a.match(/\s+/g);null==e?e=["\n"]:e.push("\n");var f=b.match(/\s+/g);if(null==f?f=["\n"]:f.push("\n"),0==c.n.length)for(var g=0;g<c.o.length;g++)d+='<del class="text-danger">'+escape(c.o[g])+e[g]+"</del>";else{if(null==c.n[0].text)for(b=0;b<c.o.length&&null==c.o[b].text;b++)d+='<del class="text-danger">'+escape(c.o[b])+e[b]+"</del>";for(var g=0;g<c.n.length;g++)if(null==c.n[g].text)d+='<ins class="text-success">'+escape(c.n[g])+f[g]+"</ins>";else{var h="";for(b=c.n[g].row+1;b<c.o.length&&null==c.o[b].text;b++)h+='<del class="text-success">'+escape(c.o[b])+e[b]+"</del>";d+=" "+c.n[g].text+f[g]+h}}return d}
